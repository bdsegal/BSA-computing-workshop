facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("KWH"^"(1/4"))
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("KWH"^"1/4"))
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("Kwh"^"1/4"))
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("Kwh"^"1/4"), x="cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
facet_wrap(~REGIONC)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
labs(y=expression("kwh"^"1/4"), x="cooling days (base temp 65 F)")+
scale_color_discrete("Region")
library(readr)
parent <- dirname(getwd())
# download the data if it doesn't already exist -- see 0.downloading_data.html for explanation
if(!file.exists(file.path(parent, "data", "recs2009.csv"))){
download.file(url="http://www.eia.gov/consumption/residential/data/2009/csv/recs2009_public.csv",
mode="wb",
destfile=file.path(parent,"data", "recs2009.csv"))
}
data <- read_csv(file.path(parent, "data", "recs2009.csv"), progress=FALSE)
prob <- problems(data)
badCol <- unique(prob$col)
badCol
layout <- read.csv("http://www.eia.gov/consumption/residential/data/2009/csv/public_layout.csv")
str(layout)
badColInfo <- layout[which(layout$Variable.Name %in% badCol),]
badColInfo
colTypes <- as.character(layout$Variable.Type)
colTypes <- gsub("Numeric","d", colTypes) # d for double
colTypes <- gsub("Character","c", colTypes) # c for character
colTypes <- paste(colTypes, collapse="") # concatenate into 1 string
data <- read_csv(file.path(parent, 'data', 'recs2009.csv'),
col_types = colTypes,
progress = FALSE)
data$REGIONC <- factor(data$REGIONC, labels=c("Northeast","Midwest","South","West"))
kwhMean <- tapply(data$KWH, data$REGIONC, mean)
barplot(kwhMean, ylab="kWh", xlab="Region")
library(reshape2)
library(dplyr)
library(ggplot2)
# Use dplyr to get both the weighted and unweighted means
regionKwhMean <- data %>%
group_by(REGIONC) %>%
summarize(
weighted = weighted.mean(x = KWH, w = NWEIGHT),
unweighted = mean(KWH)
)
# Use reshape2 to prep for gpplot2
regionKwhMeanM <- melt(regionKwhMean, id.vars = "REGIONC")
# plot with ggplot
ggplot(aes(x = factor(REGIONC), y = value, fill = variable),
data = regionKwhMeanM)+
geom_bar(stat = "identity", position = "dodge")+
theme_bw(16)+
labs(x="Region", y="kWh", title = "Regional Kilowatt-Hour Usage 2009 \n Weighted vs Unweighted Mean")+
scale_fill_discrete("")
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth()+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = factor(REGIONC), y = value), data = regionKwhMeanM)+
geom_bar(stat = "mean")+
theme_bw(16)+
labs(x="Region", y="kWh", title = "Regional Kilowatt-Hour Usage 2009 \n Unweighted Mean")+
scale_fill_discrete("")
ggplot(aes(x = factor(REGIONC), y = value), data = data)+
geom_bar(stat = "mean")+
theme_bw(16)+
labs(x="Region", y="kWh", title = "Regional Kilowatt-Hour Usage 2009 \n Unweighted Mean")+
scale_fill_discrete("")
ggplot(aes(x=KWH), data=data)+
geom_density()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, mean=mean(data$KWH^(1/4), sd=sd(data$KWH^(1/4))) color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4)), color="red")
?dnorm
mean(data$KWH^(1/4)
)
sd(data$KWH^(1/4))
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
qplot(x=data$KWH^(1/4), geom="histogram")+theme_classic()+
stat_function(fun=dnorm,
arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey")+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", alpha=0.3)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", alpha=0.3)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")+
theme_bw()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")+
theme_bw()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")+
theme_bw()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_bw()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic()
ggplot(aes(x=KWH^(1/4)), data=data)+
stat_qq()
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_void()
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_dark()
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_lassic()
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_classic(18)
qplot(x=data$KWH^(1/4), geom="histogram")+theme_classic()+
stat_function(fun=dnorm,
arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
qplot(x=log(data$KWH), geom="histogram")+theme_classic()
qplot(x=data$KWH, geom="histogram")+theme_classic()
qplot(x=log(data$KWH), geom="histogram")+theme_classic()
qplot(x=data$KWH, geom="histogram")+theme_classic(18)
qplot(x=log(data$KWH), geom="histogram")+theme_classic(18)
qplot(x=data$KWH, geom="histogram", xlab="kWh")+theme_classic(18)
qplot(x=log(data$KWH), geom="histogram", xlab="kWh")+theme_classic(18)
qplot(x=data$KWH^(1/4), geom="histogram")+theme_classic()+
stat_function(fun=dnorm,
arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))), color="red")
qplot(x=data$KWH^(1/4), geom="histogram")+theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic()
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", alpha=0.3, size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
That looks pretty normal. Let's spiff up the plot by using a kernel density estimator and overlaying a normal distribution in red. `geom_density` calls the `density` function from the `stats` package. We can also look at a q-q plot.
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red")+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", size=1, alpha=0.3)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", size=1, alpha=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", size=1, alpha=0.5)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", fill="grey")+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="grey", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(fill="black", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(sample=KWH^(1/4)), data=data)+
stat_qq()+
theme_classic(18)
mu <- mean(data$KWH)
sigma2 <- var(data$KWH)
alpha <- mu^2/sigma2
beta <- sigma2/mu
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dgamma, arg = list(shape=alpha, scale=beta),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH, data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dgamma, arg = list(shape=alpha, scale=beta),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH, data=data)+
geom_density(color="grey", fill="grey", size=1)
ggplot(aes(x=KWH, data=data), data=data)+
geom_density(color="grey", fill="grey", size=1)
ggplot(aes(x=KWH), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dgamma, arg = list(shape=alpha, scale=beta),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method=gam, family=Gamma)+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", family=Gamma)+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", arg=list(family=Gamma))+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", family="Gamma")+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh"", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH), data=data)+
geom_point(alpha=0.03)+
facet_wrap(~REGIONC)
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
ggplot(aes(x = CDD65, y = KWH), data=data)+
geom_point(alpha=0.03)+
facet_wrap(~REGIONC)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
ggplot(aes(x = CDD65, y = KWH), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
summary(data$KWH)
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")+
scale_y_continuous(lim=c(0,50000))
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.075)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")+
scale_y_continuous(lim=c(0,50000))
ggplot(aes(x = CDD65, y = KWH^(1/4), color=REGIONC), data=data)+
geom_point(alpha=0.075)+
geom_smooth()+
theme_bw(18)+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")
mu
sigma2^(1/2)
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.075)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")+
scale_y_continuous(lim=c(0,50000))
> Note: For more than 1,000 observations, geom_smooth calls the `gam` function from the [`mgcv`](https://cran.r-project.org/web/packages/mgcv/mgcv.pdf) package. `gam` stands for generalized additive model, but in this case, the smooth is a function of only one variable -- cooling days. `gam` uses cubic regression splines by default, so the smooths in the plots above are cubic regression splines within each region. Simon Wood wrote and maintains the `mgcv` package, and I highly recommend his textbook: [Generalized Additive Models: An Introduction with R](https://www.crcpress.com/Generalized-Additive-Models-An-Introduction-with-R/Wood/9781584884743).
source('~/.active-rstudio-document', echo=TRUE)
qplot(x=data$KWH^(1/4), geom="histogram", xlab=expression("kWh"^"1/4"))+theme_classic(18)
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density()+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red")+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH^(1/4)), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dnorm, arg = list(mean=mean(data$KWH^(1/4)), sd=sd(data$KWH^(1/4))),
color="red", size=1)+
theme_classic(18)+
labs(x=expression("kWh"^"1/4"), y="Density")
ggplot(aes(x=KWH), data=data)+
geom_density(color="grey", fill="grey", size=1)+
stat_function(fun=dgamma, arg = list(shape=alpha, scale=beta),
color="red", size=1)+
theme_classic(18)+
labs(x="kWh", y="Density")
ggplot(aes(x = CDD65, y = KWH, color=REGIONC), data=data)+
geom_point(alpha=0.075)+
geom_smooth(method="gam", method.args=list(family=Gamma))+
theme_bw(18)+
labs(y="kWh", x="Cooling days (base temp 65 F)")+
scale_color_discrete("Region")+
scale_y_continuous(lim=c(0,50000))
data <- read.csv(url="http://www.eia.gov/consumption/residential/data/2009/csv/recs2009_public.csv")
data <- read.csv("http://www.eia.gov/consumption/residential/data/2009/csv/recs2009_public.csv")
library(readr)
data <- read_csv("http://www.eia.gov/consumption/residential/data/2009/csv/recs2009_public.csv")
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method.args=list(weights=NWEIGHT))+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method.args=list(weights=data$NWEIGHT))+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")
ggplot(aes(x = CDD65, y = KWH^(1/4)), data=data)+
geom_point(alpha=0.03)+
geom_smooth(method.args=list(weights=NWEIGHT),data=data)+
facet_wrap(~REGIONC)+
theme_bw(18)+
geom_hline(yintercept=mean(data$KWH^(1/4)), color="red", linetype="dashed")+
labs(y=expression("kWh"^"1/4"), x="Cooling days (base temp 65 F)")
